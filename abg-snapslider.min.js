/*
    abg-snapslider.js
    =================

    SnapSlider enhances a scrolling gallery of images, videos or other content with the ability to 
    snap to the nearest element boundary. It also enables paging, page lists and experimental zoom.

    Copyright (c) 2014 Anthony Williams. You may use SnapSlider under the terms of the MIT license.
    If you wish to remove this copyright notice or are concatenating and minifying your scripts you
    must include a copy of the LICENSE file, which can be found in this script's GitHub repository,
    somewhere on your website or in your software.
    
*/+function(e){var t,n=function(t,n){this.$element=e(t);this.$slider=this.$element.find("[data-snapslider-slider]");this.$window=e(window);this.element=t;this.slider=this.$slider[0];this.options=n;this.sliderWidth=this.sliderItemCount=this.sliderItemIndex=this.sliderItemIndexTrans=this.sliderItemWidth=this.sliderItemsShown=this.sliderScrollLeft=this.sliderScrollDirection=this.sliderScrollExcess=this.sliderScrollTarget=this.sliderSnapTimeout=null;this.initialise()};n.DEFAULTS={ssEnablePagination:!0,ssEnablePagelist:!0,ssEnableZoom:!1,ssEnableZoomtopage:!1,ssDisableKeyboardEvents:!1,ssActivated:"ss--active",ssPaginationActivated:"ss--pagination-active",ssPagelistActivated:"ss--pagelist-active",ssZoomActivated:"ss--zoom-active",ssBaseClass:"gallery",ssElementSeparator:"__",ssModifierSeparator:"--",ssGroupingSeparator:"-",ssPagerClass:"pager",ssPagerNextModifier:"next",ssPagerPrevModifier:"prev",ssPagerActiveModifier:"active",ssPagelistClass:"pagelist",ssPagelistListElement:"ul",ssPagelistItemElement:"li",ssPagerContainerElement:"div",ssPagerElement:"a",ssPagerInnerElement:"span",ssPagerPrevHtml:"&lsaquo;",ssPagerNextHtml:"&rsaquo;",ssHiddenModifier:"hidden",ssZoomModifier:"zoom",ssAnimDuration:250,ssScrollDelay:250,ssResizeDelay:100,ssSnapTolerance:.1};n.prototype.initialise=function(){this.$sliderItems=this.$slider.find("[data-snapslider-item]");this.sliderItemCount=this.$sliderItems.length;this.sliderScrollLeft=this.slider.scrollLeft;this.sliderScrollDirection=0;this.setItemWidth();this.$slider.on("scroll",e.proxy(this.scroll,this));this.$window.on("resize",e.proxy(this.resize,this));this.options.ssEnablePagination&&this.enablePagination();this.options.ssEnablePagelist&&this.enablePagelist();this.options.ssEnableZoom&&this.enableZoom();!this.options.ssDisableKeyboardEvents&&this.enableKeyboardEvents();this.snap();this.$element.addClass(this.options.ssActivated)};n.prototype.enablePagination=function(){var t,n,r=this.options.ssBaseClass+this.options.ssElementSeparator+this.options.ssPagerClass+"s",i=this.options.ssBaseClass+this.options.ssElementSeparator+this.options.ssPagerClass,s=i+this.options.ssModifierSeparator+this.options.ssPagerPrevModifier,o=i+this.options.ssModifierSeparator+this.options.ssPagerNextModifier,u=document.createElement(this.options.ssPagerContainerElement),a=document.createElement(this.options.ssPagerElement),f=document.createElement(this.options.ssPagerElement);this.options.ssPagerElement=="a"&&(a.href=f.href="#");u.className=r;a.className=f.className=i;a.className+=" "+s;f.className+=" "+o;if(this.options.ssPagerInnerElement){t=document.createElement(this.options.ssPagerInnerElement),n=document.createElement(this.options.ssPagerInnerElement);t.innerHTML=this.options.ssPagerPrevHtml;n.innerHTML=this.options.ssPagerNextHtml;a.appendChild(t);f.appendChild(n)}else{a.innerHTML=this.options.ssPagerPrevHtml;f.innerHTML=this.options.ssPagerNextHtml}this.$sliderPagerPrev=e(a);this.$sliderPagerNext=e(f);e(a).on("click",e.proxy(function(e){e.preventDefault();this.paginate(-1)},this));e(f).on("click",e.proxy(function(e){e.preventDefault();this.paginate(1)},this));u.appendChild(a);u.appendChild(f);this.element.appendChild(u);this.setPaginationVisibility();this.$element.addClass(this.options.ssPaginationActivated)};n.prototype.enablePagelist=function(){var t,n,r,i,s=this.options.ssBaseClass+this.options.ssElementSeparator+this.options.ssPagelistClass,o=s+this.options.ssGroupingSeparator+this.options.ssPagerClass,u=o+"s";this.sliderPagelistPagerActiveClass=o+this.options.ssModifierSeparator+this.options.ssPagerActiveModifier;t=e('<table class="'+s+'"><tr><td><'+this.options.ssPagelistListElement+' class="'+u+'"></'+this.options.ssPagelistListElement+"></td></tr></table>");n=t.find(this.options.ssPagelistListElement);for(r=0;r<this.sliderItemCount;r++){i=e("<"+this.options.ssPagelistItemElement+' class="'+o+'"><'+this.options.ssPagerInnerElement+">"+(r+1)+"</"+this.options.ssPagerInnerElement+"></"+this.options.ssPagelistItemElement+">");i.on("click",e.proxy(this.goToPage,this,r));n.append(i)}this.$pagelistItems=n.find("."+o);this.$element.append(t);this.setPagelistItemVisibility()};n.prototype.enableZoom=function(){var t;for(t=0;t<this.sliderItemCount;t++)e(this.$sliderItems[t]).on("click",e.proxy(this.zoom,this,t));this.$slider.bind("webkitTransitionEnd oTransitionEnd otransitionend transitionend",e.proxy(this.transition,this));this.sliderZoomClass=this.options.ssBaseClass+this.options.ssModifierSeparator+this.options.ssZoomModifier;this.sliderZoomed=this.$element.hasClass(this.sliderZoomClass);this.$element.addClass(this.options.ssZoomActivated)};n.prototype.enableKeyboardEvents=function(){!e("[data-snapslider]").attr("tabindex")&&e("[data-snapslider]").attr("tabindex","0");this.$element.bind("keydown",e.proxy(this.keydown,this));this.$element.bind("keyup",e.proxy(this.keyup,this))};n.prototype.scroll=function(){this.sliderScrollDirection=this.slider.scrollLeft>this.sliderScrollLeft?1:-1;this.sliderScrollLeft=this.slider.scrollLeft;this.setSnapTimeout(this.options.ssScrollDelay)};n.prototype.resize=function(){this.setItemWidth();this.setSnapTimeout(this.options.ssResizeDelay)};n.prototype.transition=function(){this.sliderScrollLeft=this.slider.scrollLeft;this.setItemWidth();this.options.ssEnableZoomtopage?this.goToPage(this.sliderItemIndexTrans):this.snap()};n.prototype.keydown=function(e){if(e.keyCode!=37&&e.keyCode!=39)return;e.preventDefault()};n.prototype.keyup=function(e){if(e.keyCode!=37&&e.keyCode!=39)return;this.goToPage(this.sliderItemIndex+(e.keyCode==37?-1:1));e.preventDefault()};n.prototype.setItemWidth=function(){this.sliderItemWidth=this.slider.scrollWidth/this.sliderItemCount;this.sliderItemsShown=Math.round(this.slider.clientWidth/this.sliderItemWidth)};n.prototype.setSnapTimeout=function(t){window.clearTimeout(this.sliderSnapTimeout);this.sliderSnapTimeout=window.setTimeout(e.proxy(this.snap,this),t)};n.prototype.setPaginationVisibility=function(){var e=this.options.ssBaseClass+this.options.ssElementSeparator+this.options.ssPagerClass+this.options.ssModifierSeparator+this.options.ssHiddenModifier;this.sliderItemIndex<=0?this.$sliderPagerPrev.addClass(e):this.$sliderPagerPrev.removeClass(e);this.sliderItemIndex>=this.sliderItemCount-this.sliderItemsShown?this.$sliderPagerNext.addClass(e):this.$sliderPagerNext.removeClass(e)};n.prototype.setPagelistItemVisibility=function(){var t;for(t=0;t<this.sliderItemCount;t++)t>=this.sliderItemIndex&&t<this.sliderItemIndex+this.sliderItemsShown?e(this.$pagelistItems[t]).addClass(this.sliderPagelistPagerActiveClass):e(this.$pagelistItems[t]).removeClass(this.sliderPagelistPagerActiveClass)};n.prototype.snap=function(){var e;this.sliderItemIndex=this.sliderScrollLeft/this.sliderItemWidth;this.sliderScrollExcess=this.sliderItemIndex%1;if(this.sliderScrollExcess==0){this.options.ssEnablePagination&&this.setPaginationVisibility();this.options.ssEnablePagelist&&this.setPagelistItemVisibility();return}e=this.sliderItemIndex;this.sliderScrollExcess<.5&&this.sliderScrollExcess<=this.options.ssSnapTolerance||this.sliderScrollExcess>.5&&this.sliderScrollExcess>=1-this.options.ssSnapTolerance?this.sliderScrollExcess<.5?e=Math.floor(e):e=Math.ceil(e):e=Math.floor(e)+Math.max(0,this.sliderScrollDirection);this.sliderItemIndex=e;this.animate();this.options.ssEnablePagination&&this.setPaginationVisibility();this.options.ssEnablePagelist&&this.setPagelistItemVisibility()};n.prototype.animate=function(){this.sliderScrollTarget=this.sliderItemWidth*this.sliderItemIndex;this.$slider.animate({scrollLeft:this.sliderScrollTarget},this.options.ssAnimDuration)};n.prototype.paginate=function(e){this.goToPage(this.sliderItemIndex+(e<=0?-1:1))};n.prototype.goToPage=function(e){this.sliderItemIndex=Math.max(0,Math.min(this.sliderItemCount-this.sliderItemsShown,e));this.animate();this.options.ssEnablePagination&&this.setPaginationVisibility();this.options.ssEnablePagelist&&this.setPagelistItemVisibility()};n.prototype.zoom=function(e){this.$element.toggleClass(this.sliderZoomClass);this.sliderZoomed=this.$element.hasClass(this.sliderZoomClass);this.setItemWidth();if(this.options.ssEnableZoomtopage){this.sliderItemIndex=this.sliderItemIndexTrans=e;this.goToPage(e)}else this.snap()};t=e.fn.slapSlider;e.fn.snapSlider=function(t){return this.each(function(){var r=e(this),i=r.data("abg.snapslider"),s=e.extend({},n.DEFAULTS,r.data(),typeof t=="object"&&t);i||r.data("abg.snapslider",i=new n(this,s));typeof t=="string"&&i[t]()})};e.fn.snapSlider.Constructor=n;e.fn.snapSlider.noConflict=function(){e.fn.snapSlider=t;return this};e(function(){e("[data-snapslider]").each(function(){var t=e(this),n=t.data("abg.snapslider")?"initialise":t.data();t.snapSlider(n)})})}(jQuery);